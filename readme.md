## 绝佳的数字电子技术实践

### TD4 CPU原理详细教程
## 简介
如何使用9种14个74系列芯片，自己构造一个4位CPU（中央处理）的可编程计算机系统
 
CPU的核心原理其实非常简单，其实任何人都只需要非常基础的一点数字电子技术知识，就可以用14个74系列芯片，完成一个4位简单计算机的设计。这本大概在十几年前就已经在日本出版并风靡电子爱好者圈子的一本好书，既可以给对计算机工作原理好奇的青年爱好者作为制作范例，又可以成为让大学本科学完数字电子技术等相关课程后用于学生大作业或课程设计改进的雏形和范例（实话说，比交通的什么之类的例子实在是好太多，因为今天是计算机的时代，大家显然会对这样的例子兴趣更加浓厚）。我花了大概一天半的时间，就基本搞懂了这个例子的原理，写下这篇文档分享给大家，希望大家也能向我一样动手坐一坐，对数字计算机的工作原理感悟体会更深刻，共勉！

### 总电路图（点击可放大）

 ![](https://files.mdnice.com/user/16190/ea327aa6-8125-46a9-af5c-a3f2197ce0bd.png)

### 为什么要这么做？
虽然功能简单，但是个完整的CPU，麻雀虽小五脏俱全
采用9种小规模集成电路芯片（74系列），完成数字电路设计的基础学习，可以彻底直观理解到电路工作层的原理。

### 立即购买套件：
https://item.taobao.com/item.htm?spm=a1z10.1-c.w4004-23785864172.6.4f231fe7l9UOLu&id=647177997616

-现在可以轻松获得3GHz-5GHz的高速处理器，就连不到一美元的处理器，其工作频率也在10M左右，计算位数也在16甚至是32位，我们自己搭建一个一个意义是什么？
 
并非没有意义，原因如下
- 从电路层面直观了解运算过程
- 直观理解各个部分的组成原理（到数字电路层面）
- 简化的4位数，不至于眼花缭乱
- 只有12个指令，也足以完成一些编程任务

其次要制定CPU的规格
- 只操作4位数
- 仅10简单的中小规模集成电路芯片（74系列）
- 可编程指令只有16条
- 演示和改造的实用性都很强

这是一个典型的解剖模型（麻雀虽小 五脏俱全）
采用机器语言编程，可以完全直观理解并看到其运行过程，可手动也可自动操作

### 这个项目适合哪些人？
有初步或者想初步学习数字电路的人
想了解CPU工作和设计思路的非专业人员、正在学习电子及计算机专业的学生

### 经过这个项目，你会收获些什么？
中规模集成电路，如74系列芯片，该怎么应用到实际需求中去
彻底理解一个简化版本的CPU的每个运作细节

# 教程开始啦！
### 74系列芯片
什么是74系列芯片，相信学过数字电子技术的同学都不会陌生，课本里都有频繁的举例，但为了完整补充相关产业背景的知识，这里还是引用一下维基百科的说法：

7400系列是典型的中小规模数字逻辑集成电路。 在 1960 年代中期，最初的 7400 系列集成电路由德州仪器 (TI) 引入，前缀为“SN”，以创建名称 SN74xx。 由于这些零件的普及，其他制造商发布了引脚对引脚兼容的逻辑器件，并保留了 7400 序列号作为识别兼容部件的辅助工具。 但是，其他制造商在其部件号上使用不同的前缀和后缀。

二值逻辑和逻辑电平、正负逻辑电平
二进制数正好是利用二值数字逻辑中的０和１来表示的。
二值数字逻辑是Binary Digital Logic的译称。

本系统中，由于采用USB接口供电，用5V表示1，0V表示0。

在本系统中，一般采用正逻辑（即高电平有效），如所表示的数据线上有一横杠线或者器件输入输出口处有一小圆圈，则表示负逻辑（即低电平有效）。
![](https://files.mdnice.com/user/16190/c5ebdbfe-245f-4662-b369-564da536997f.png)

更多专业详尽的信息和说明，请查阅数字电子技术基础课本中的相关章节

### 如何查看74系列芯片的Datasheet
规格表(Data sheet)数据表，数据表或规格表是对产品，机器，组件，材料，子系统或软件的性能和其他特性进行了足够详细的总结的文档，使买家能够了解产品的含义以及设计工程师要了解组件在整个系统中的作用。通常，数据表由制造商创建，以介绍文档其余部分的介绍性页面开头，然后列出特定特征，并提供有关设备连接的更多信息。

本项目使用了8种74系列芯片，我们都采用74HC型号，相关的规格书可以在https://www.alldatasheet.com/网站查询到，个人倾向于阅读德州仪器TI公司较新的Datasheet文档，因为其资料丰富且格式规范。德州仪器公司的SN54系列和SN74系列在功能上完全一致，规格书也是共用的，所以查找规格书时，如书上所示74LS10，网上也可以搜索SN54HC10，只是54系列芯片用于军用。

我刚上大学那会，一开始阅读英文规格书材料也非常不适应，因为从小到大的数理化教育都是非英语环境进行的，但作为电子、信息、自动化和计算机相关专业的学生和从业者，这一点将来无法避免，只好捧起英文资料一遍查资料一遍看，再借助一些中文参考书，慢慢的大家受到的困难的阻力越来越小，阅读越来越顺畅，希望读者也要尝试坚持下去，一定会受益匪浅的。

### 74HC/LS/HCT/F系列芯片的区别
74系列集成电路大致可分为6大类：
- 74××（标准型）；
- 74LS××（低功耗肖特基）；
- 74S××（肖特基）；
- 74ALS××（先进低功耗肖特基）；
- 74AS××（先进肖特基）；
- 74F××（高速）。

同型号的74系列、74HC系列、74LS系列芯片，逻辑功能上是一样的。74LSxx的使用说明如果找不到的话，可参阅74xx或74HCxx的使用说明。74HC的速度比4000系列快，引脚与标准74系列兼容 4000系列的好处是有的型号可工作在+15V 。新产品最好不用LS。

### 74系列芯片和逻辑门电路的关系
像74这一类的所有芯片都需要电源正负供电，其余部分则往往作为信号输入输出的功能引脚，在电路设计布局时，对于简单功能的芯片，门电路符号和芯片引脚标识方式常常混用，这时需要我们查阅芯片Datasheet来确认其对应关系，以74HC10为例，我们查到规格书的地址是：https://pdf1.alldatasheet.com/datasheet-pdf/view/203930/TI/SN54HC10.html
通过在规格书中，下面两张示意图，即可理解在实际电路中如何使用该芯片：
 ![](https://files.mdnice.com/user/16190/7214855f-c00b-44bc-a5dd-245b61732692.png =80%x) 
 
 ![](https://files.mdnice.com/user/16190/a732c77d-1bbc-4e3d-bd48-388ad4211d96.png =80%x)
 

### 什么是CPU-逐项理解冯诺依曼原理
- 程序计数器从内存中获取指令（取指令）
- 根据解码结果执行操作（执行指令）
- 存储计算结果（存储结果）
（上述三个过程可以比拟成逐页翻书，理解书中内容，并尝试拿笔记本记录下来的过程）
机器的每个 时钟脉冲周期，都会重复上述的几个过程

### 仿真器
接下来，我们先来看一个仿真器，此时此刻你并不需要理解这个仿真器中的所有细节，等后续讲述中，每个部分理解后，再回来重看此动态仿真程序，即可全面理解。[https://vanya.jp.net/td4/](https://vanya.jp.net/td4/)
![](https://files.mdnice.com/user/16190/67ca234b-9f1f-43fb-b3a8-034669878bdb.png)

### 现在，你看此仿真程序运行图，所需要知道的事情有以下几点：
1、	红色线代表此时该线上电平为高（5V），蓝色代表电平为低（即0V）

2、	整个系统由CLOCK脉冲驱动进行，RESET低电平有效，即RESET被拉低后，系统里所有数据清零重启
如果你已经学过数字电路基础，那么你应该还可以尝试记住并理解以下几点，如果不能或全部理解也没关系，可以全部学完，回来再看看

3、	四个74HC161分别为寄存器A、B、C、D，分别可用于存储4个比特的数据

4、	第三个寄存器C的输出，用于输出4位电平，驱动LED

5、	第四个寄存器D的输出，用作指令的译码，即作为地址总线的A0-A3（Address0-Address3）

6、	两个74HC153组成了一个4位四路数据选择器，用于选择哪一路的4位数据给后续的四位全加器做加数A。其中，第三路的4位数据来源于4位拨码开关（即输入），第四路不连接被弃用。

7、	74HC283是一个四路全加器，它的第一个加数来源于两个74HC153的数据选择通道，第二个加数来源于指令数据的低4位（即D3-D0），这种被包含在指令中参与运算的数据又叫立即数immediate。全加器的求和结果将输出给4位寄存器A、B、C、D均可，选择其中哪一个寄存器记忆结果，完全由每个寄存器输入端的LOAD（~LD）信号决定，请注意LOAD是低电平有效，这是后续指令译码结果中控制总线的最重要一部分。

8、	全加器有溢出位输出Carry，但是无法记忆上一次的计算结果是否溢出，故需要一个D触发器作为溢出标记位记住上一次的求和结果是否溢出，并送给译码器指令。

9、	图上所有用门电路表示的组合电路，是一个完整的指令解码器，它由取得指令的高4位（即D7-D4）和溢出标记位一起作为译码器的输入，由控制四个寄存器的加载（LD）和两个数据选择器的A、B作为输出，这是典型的控制总线。


# 更多详情请看知乎教程
## https://zhuanlan.zhihu.com/p/381501879
